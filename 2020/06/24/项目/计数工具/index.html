<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>python统计微信推送中数字出现的次数 | Mi manchi</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">python统计微信推送中数字出现的次数</h1><a id="logo" href="/.">Mi manchi</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">python统计微信推送中数字出现的次数</h1><div class="post-meta">2020-06-24<span> | </span><span class="category"><a href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a></span></div><div class="post-content"><ol type="1">
<li>实现过程</li>
</ol>
<p>首先我只是在jupyter里面调试（不得不说加了插件的jupyter notebook作为开发环境简直不要太爽，只要打开浏览器就可以），导入必要的包，读取文件的sys库，以及正则库re</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br></pre></td></tr></table></figure>
<p>然后就是读取文件，将文本进行处理，包括去除换行符，空格等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">result = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'test.txt'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line"> 		result.append(list(line.strip(<span class="string">'\n'</span>).split(<span class="string">','</span>)))</span><br><span class="line"><span class="comment">#print(result)</span></span><br><span class="line">m = [n <span class="keyword">for</span> a <span class="keyword">in</span> result <span class="keyword">for</span> n <span class="keyword">in</span> a]</span><br><span class="line">n = <span class="string">""</span>.join(m)</span><br><span class="line">o = n.replace(<span class="string">' '</span>, <span class="string">''</span>)</span><br><span class="line">print(<span class="string">"原始文本"</span>, o)</span><br></pre></td></tr></table></figure>
<p>考虑到日期时间不能算进去，首先得去除日期时间，利用正则语法匹配常见的日期格式，再去除即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg = re.compile(<span class="string">'(20\d&#123;2&#125;([\.\-/|年月\s]&#123;1,3&#125;\d&#123;1,2&#125;)&#123;2&#125;日?(\s?\d&#123;2&#125;:\d&#123;2&#125;(:\d&#123;2&#125;)?)?)|(\d&#123;1,2&#125;\s?(分钟|小时|天)前)'</span>)</span><br></pre></td></tr></table></figure>
<p>剩下来的就好了，根据统计出来的与数字同时出现的词语，包括"个"、"元"等量词和"超过"、"超"等前置词以及"~"、"至"等连接词来进行统计即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = re.findall(<span class="string">'([0-9.]+%)(~|\-|到|至)([0-9.]+%)'</span>, N)</span><br><span class="line">b = re.findall(<span class="string">'([0-9.]+)(%|百|美|城|克|-|版|估|手|\|合|世|逾|英|来|票|港|关|房|笔|市|折|涨|平|套|板|毫|微|起|派|区|的|两|附|宗|一|千|[A-Za-z]|毛|动态|指数|台|条|辆|元|城市|高|转|（|袋|股|行|万|处|人|、|型|“|左右|等|分|件|字|是|米|号|位|届|名|后|次|欧|℃|斤|公里|点|场|英里|位|周|架|座|度|M|成|寸|秒|P|k|像素|分钟|K|G|省|小时|公斤|项|户|吨|大|百万|金|种|份|岁|年|款|只|千万|亿|倍|余|多|天|以上|左右元|块|支|美元|家|个|亩|平米|平方米|平方千米|基点|关口)'</span>, O)</span><br><span class="line">c=re.findall(<span class="string">'(超过|超|近|名|或|比|现|高|及|入|逾|值|强|数|到|的|看|涨|自|是|至|以||上|冲|从|探|点|报|达|大|在|约|共计|为|[A-Za-z]|于|总计|分|出|了|前|第|合计|达到|增加|增长|上升|下降|跌破|击穿|产值|持股)([0-9.]+)'</span>,NN)</span><br></pre></td></tr></table></figure>
<p>最后将这些统计加起来就可以了，但是在实际使用时，总是有你想不到的量词，前置词甚至连接词（这时总让人感叹中华文化博大精深），但这种误差又不能忽视，因此又添加了一行检测遗漏的代码（这里是不是和机器学习一个意思🐶）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR=re.findall(<span class="string">'(.&#123;2&#125;[0-9.]+.&#123;2&#125;)'</span>,NNN)</span><br></pre></td></tr></table></figure>
<ol start="2" type="1">
<li>图形化</li>
</ol>
<p>python自带的tkinter库可以初步满足UI的需求，因此做了个图形化工具，涉及窗口、文本、按钮、标签、菜单、菜单树、滚动条、文件处理、界面布局等</p>
<ul>
<li>新建父窗口（可理解为界面的最底层）</li>
</ul>
<p>可以对其进行背景色，大小等条件设置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gui_start</span><span class="params">()</span>:</span></span><br><span class="line">    init_window = Tk()        <span class="comment">#实例化出一个父窗口</span></span><br><span class="line">    init_window.mainloop()    <span class="comment">#父窗口进入事件循环，可以理解为保持窗口运行，否则界面不展示</span></span><br><span class="line"></span><br><span class="line">gui_start()</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure>
<img src="https://github.com/lifeiyang79/Test2/blob/master/files/pics/count_tool_pic_1.jpg?raw=true" alt="" /><figcaption>count_tool_pic_1.jpg</figcaption>
</figure>
<p>整理下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MY_GUI</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,init_window_name)</span>:</span></span><br><span class="line">        self.init_window_name = init_window_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#设置窗口</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_init_window</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.init_window_name.title(<span class="string">"文本处理工具_v1.2   by: 飞扬)      #窗口名</span></span><br><span class="line"><span class="string">        self.init_window_name.geometry('1068x680+10+10')                 #290 160为窗口大小，+10 +10 定义窗口弹出时的默认展示位置</span></span><br><span class="line"><span class="string">        self.init_window_name["</span>bg<span class="string">"] = "</span>pink<span class="string">"                            #窗口背景色，其他背景色见：blog.csdn.net/chl0000/article/details/7657887</span></span><br><span class="line"><span class="string">        self.init_window_name.attributes("</span>-alpha<span class="string">",0.9)                  #虚化，值越小虚化程度越高</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def gui_start():</span></span><br><span class="line"><span class="string">    init_window = Tk()              #实例化出一个父窗口</span></span><br><span class="line"><span class="string">    ZMJ_PORTAL = MY_GUI(init_window)</span></span><br><span class="line"><span class="string">    # 设置根窗口默认属性</span></span><br><span class="line"><span class="string">    ZMJ_PORTAL.set_init_window()</span></span><br><span class="line"><span class="string">                                    </span></span><br><span class="line"><span class="string">    init_window.mainloop()          #父窗口进入事件循环，可以理解为保持窗口运行，否则界面不展示</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gui_start()</span></span><br></pre></td></tr></table></figure>
<ul>
<li>基于父窗口创建其他组件</li>
</ul>
<p>以数字统计为例，介绍数据读取、按钮、布局、事件触发、后台转换处理、界面展示结果。</p>
<ol type="1">
<li>标签</li>
</ol>
<p>标签可以使用tkinter里的Label()方法，生成标签，括号内可带入其他属性参数； 生成标签后需使用grid()或者pack()方法使其展示；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">self.init_data_label = Label(self.init_window_name, text=<span class="string">"待处理数据"</span>)</span><br><span class="line">self.init_data_label.grid(row=<span class="number">0</span>, column=<span class="number">0</span>)</span><br><span class="line">self.result_data_label = Label(self.init_window_name, text=<span class="string">"输出结果"</span>)</span><br><span class="line">self.result_data_label.grid(row=<span class="number">0</span>, column=<span class="number">12</span>)</span><br></pre></td></tr></table></figure>
<ol start="2" type="1">
<li>文本框</li>
</ol>
<p>tkinter库中的Text()方法，可以创建一个文本框，用于数据的录入和结果展示；</p>
<p>Text()方法可以传入其他参数值，用于定义如背景颜色，前景色，字体，字号、字色等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">self.init_data_Text = Text(self.init_window_name, width=<span class="number">67</span>, height=<span class="number">35</span>)  <span class="comment">#原始数据录入框</span></span><br><span class="line">self.init_data_Text.grid(row=<span class="number">1</span>, column=<span class="number">0</span>, rowspan=<span class="number">10</span>, columnspan=<span class="number">10</span>)</span><br><span class="line">self.result_data_Text = Text(self.init_window_name, width=<span class="number">70</span>, height=<span class="number">49</span>)  <span class="comment">#处理结果展示</span></span><br><span class="line">self.result_data_Text.grid(row=<span class="number">1</span>, column=<span class="number">12</span>, rowspan=<span class="number">15</span>, columnspan=<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<ol start="3" type="1">
<li>按钮</li>
</ol>
<p>按钮的创建可以使用Button()方法实现，可自定义按钮大小，宽度，按钮文本，背景色，以及需要触发的事件；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.str_trans_to_md5_button = Button(self.init_window_name, text=<span class="string">"字符串转MD5"</span>, bg=<span class="string">"lightblue"</span>, width=<span class="number">10</span>,command=self.str_trans_to_md5)  <span class="comment"># 调用内部方法  加()为直接调用</span></span><br><span class="line">self.str_trans_to_md5_button.grid(row=<span class="number">1</span>, column=<span class="number">11</span>)</span><br></pre></td></tr></table></figure>
<ol start="4" type="1">
<li>事件代码：后台处理</li>
</ol>
<p>step3中在定义按钮时，会选择触发一个事件（或称为函数），函数的实现涉及：从界面文本框中读取待处理数据---逻辑处理---界面结果文本框展示，这里的功能函数即就是前面的数字统计函数。</p>
<ol start="5" type="1">
<li>日志打印</li>
</ol>
<p>和上面没啥区别，直接贴代码了.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取当前时间</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_current_time</span><span class="params">(self)</span>:</span></span><br><span class="line">    current_time = time.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>,time.localtime(time.time()))</span><br><span class="line">    <span class="keyword">return</span> current_time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志动态打印</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_log_to_Text</span><span class="params">(self,logmsg)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> LOG_LINE_NUM</span><br><span class="line">    current_time = self.get_current_time()</span><br><span class="line">    logmsg_in = str(current_time) +<span class="string">" "</span> + str(logmsg) + <span class="string">"\n"</span>      <span class="comment">#换行</span></span><br><span class="line">    <span class="keyword">if</span> LOG_LINE_NUM &lt;= <span class="number">7</span>:</span><br><span class="line">        self.log_data_Text.insert(END, logmsg_in)</span><br><span class="line">        LOG_LINE_NUM = LOG_LINE_NUM + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        self.log_data_Text.delete(<span class="number">1.0</span>,<span class="number">2.0</span>)</span><br><span class="line">        self.log_data_Text.insert(END, logmsg_in)</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/lifeiyang79/Test2/blob/master/files/count_tool_1.1.py" target="_blank" rel="noopener">整体代码</a></p>
<p>运行结果为：</p>
<figure>
<img src="https://github.com/lifeiyang79/Test2/blob/master/files/pics/count_tool_pic_2.jpg?raw=true" alt="" /><figcaption>count_tool_pic_2.jpg</figcaption>
</figure>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2020/06/24/%E6%91%98%E6%8A%84/6.18%E5%89%8D/">6.18前</a><a class="next" href="/2020/06/24/%E6%83%B3%E6%B3%95/%E9%9D%9E%E7%BA%BF%E6%80%A7/">我关于非线性物理的感想</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/dairy/">dairy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/idea/">idea</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%91%98%E6%8A%84/">摘抄</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/07/21/%E6%91%98%E6%8A%84/4/">2020.7.18-7.21</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/17/%E6%91%98%E6%8A%84/3/">2020.7.12-7.17</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/%E6%91%98%E6%8A%84/2/">2020.6-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/24/%E6%91%98%E6%8A%84/6.18%E5%89%8D/">6.18前</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/24/%E9%A1%B9%E7%9B%AE/%E8%AE%A1%E6%95%B0%E5%B7%A5%E5%85%B7/">python统计微信推送中数字出现的次数</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/24/%E6%83%B3%E6%B3%95/%E9%9D%9E%E7%BA%BF%E6%80%A7/">我关于非线性物理的感想</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/18/%E6%97%A5%E8%AE%B0/%E5%86%8D%E6%AC%A1%E5%87%BA%E5%8F%91/">再次出发</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Mi manchi.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>